import{p as M,d as P,u as A}from"./jtt808-PzOwMx6L.js";import{d as E,r as y,j as J,b as I,c as t,w as a,f as r,h as n,y as C,z as L,F as V,t as x,x as j,i as T,o as c,_ as R}from"./index-BYlyECpH.js";import"./request-xFzgdMuq.js";const $=E({__name:"ClientView",setup(q){const S=[{title:"终端手机号",dataIndex:"clientId",key:"clientId"},{title:"车辆标识",dataIndex:"plateNo",key:"plateNo"},{title:"版本",dataIndex:"version",key:"version"},{title:"终端型号",dataIndex:"deviceModel",key:"deviceModel"},{title:"终端ID",dataIndex:"deviceId",key:"deviceId"},{title:"终端地址",key:"clientAddress"},{title:"通道数量",dataIndex:"maxVideoChannels",key:"maxVideoChannels"},{title:"状态",key:"status"},{title:"心跳时间",dataIndex:"keepaliveTime",key:"keepaliveTime"},{title:"注册时间",dataIndex:"registTime",key:"registTime"},{title:"操作",key:"action",fixed:"right",width:350}],_=y([]),i=y({current:1,pageSize:10,total:0}),s=y({clientId:"",clientIp:"",online:void 0}),g=y(!1),z=()=>{s.value={clientId:"",clientIp:"",online:void 0},m(1,i.value.pageSize)},h=()=>{i.value.current=1,m(1,i.value.pageSize)},m=async(l,e)=>{try{g.value=!0;const d={pageNo:l-1,pageSize:e,clientId:s.value.clientId,clientIp:s.value.clientIp,online:s.value.online},v=await M(d);_.value=v.data.content.map(p=>({...p,loading:!1,loading1:!1})),i.value.total=v.data.page.totalElements,i.value.current=l}catch(d){console.error("获取数据失败:",d)}finally{g.value=!1}},N=l=>{const{current:e,pageSize:d}=l;m(e,d)};J(()=>{m(i.value.current,i.value.pageSize)});const D=(l,e)=>{l.maxVideoChannels=e,A(l).then(d=>T.success(d.message))},U=async l=>{l.loading1=!0;try{const e=await P({clientId:l.clientId});T.success(e.message)}catch(e){console.log(e)}finally{l.loading1=!1}await m(i.value.current,i.value.pageSize)};return(l,e)=>{const d=r("a-input"),v=r("a-form-item"),p=r("a-select-option"),w=r("a-select"),k=r("a-button"),B=r("a-form"),b=r("router-link"),F=r("a-table");return c(),I("div",null,[t(B,{layout:"inline",style:{"margin-bottom":"16px"}},{default:a(()=>[t(v,{label:"终端手机号"},{default:a(()=>[t(d,{value:s.value.clientId,"onUpdate:value":e[0]||(e[0]=u=>s.value.clientId=u),placeholder:"请输入终端手机号",allowClear:""},null,8,["value"])]),_:1}),t(v,{label:"终端IP"},{default:a(()=>[t(d,{value:s.value.clientIp,"onUpdate:value":e[1]||(e[1]=u=>s.value.clientIp=u),placeholder:"请输入终端IP",allowClear:""},null,8,["value"])]),_:1}),t(v,{label:"状态"},{default:a(()=>[t(w,{value:s.value.online,"onUpdate:value":e[2]||(e[2]=u=>s.value.online=u),placeholder:"请选择状态",allowClear:"",style:{width:"120px"},"default-value":void 0},{default:a(()=>[t(p,{value:"1"},{default:a(()=>e[3]||(e[3]=[n("在线")])),_:1}),t(p,{value:"0"},{default:a(()=>e[4]||(e[4]=[n("离线")])),_:1})]),_:1},8,["value"])]),_:1}),t(v,null,{default:a(()=>[t(k,{onClick:h,loading:g.value},{default:a(()=>e[5]||(e[5]=[n("查询")])),_:1},8,["loading"]),t(k,{style:{"margin-left":"8px"},onClick:z},{default:a(()=>e[6]||(e[6]=[n("重置")])),_:1})]),_:1})]),_:1}),t(F,{columns:S,"data-source":_.value,pagination:i.value,onChange:N,loading:g.value,scroll:{x:"max-content"}},{bodyCell:a(({column:u,record:o})=>[u.key==="clientAddress"?(c(),I(V,{key:0},[n(x(o.clientIp)+":"+x(o.clientPort),1)],64)):C("",!0),u.key==="maxVideoChannels"?(c(),L(w,{key:1,ref:"select",value:o.maxVideoChannels,"onUpdate:value":f=>o.maxVideoChannels=f,style:{width:"120px"},onChange:f=>D(o,f)},{default:a(()=>[t(p,{value:"1"},{default:a(()=>e[7]||(e[7]=[n("1")])),_:1}),t(p,{value:"2"},{default:a(()=>e[8]||(e[8]=[n("2")])),_:1}),t(p,{value:"3"},{default:a(()=>e[9]||(e[9]=[n("3")])),_:1}),t(p,{value:"4"},{default:a(()=>e[10]||(e[10]=[n("4")])),_:1})]),_:2},1032,["value","onUpdate:value","onChange"])):C("",!0),u.key==="status"?(c(),I("span",{key:2,style:j({color:o.online=="1"?"green":"red"})},x(o.online=="1"?"在线":"离线"),5)):C("",!0),u.key==="action"?(c(),I(V,{key:3},[t(b,{to:"/JTT808/ClientChannelView?clientId="+o.clientId,style:{"margin-right":"10px"}},{default:a(()=>e[11]||(e[11]=[n("通道")])),_:2},1032,["to"]),t(b,{to:"/JTT808/ClientLocationView?clientId="+o.clientId,style:{"margin-right":"10px"}},{default:a(()=>e[12]||(e[12]=[n("位置")])),_:2},1032,["to"]),t(k,{danger:"",onClick:f=>U(o),style:{"margin-right":"10px"},loading:o.loading1},{default:a(()=>e[13]||(e[13]=[n("删除")])),_:2},1032,["onClick","loading"])],64)):C("",!0)]),_:1},8,["data-source","pagination","loading"])])}}}),O=R($,[["__scopeId","data-v-845118d1"]]);export{O as default};
