import{h as A,c as D}from"./jtt808-PzOwMx6L.js";import{d as E,r as i,j as M,b as y,e as b,c as l,w as n,f as u,F as w,h as _,y as I,i as L,o as N,_ as q}from"./index-BYlyECpH.js";import"./request-xFzgdMuq.js";const G={class:"search-form",style:{"margin-bottom":"16px"}},H=["href","download"],J=["src"],K=E({__name:"RecordView",setup(O){const C=[{title:"终端手机号",dataIndex:"clientId",key:"clientId"},{title:"通道序号",dataIndex:"channelNo",key:"channelNo"},{title:"开始时间",dataIndex:"startTime",key:"startTime"},{title:"结束时间",dataIndex:"endTime",key:"endTime"},{title:"文件大小",dataIndex:"fileSize",key:"fileSize"},{title:"文件名称",dataIndex:"fileName",key:"fileName"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",key:"action",fixed:"right",width:350}],k=i([]),a=i({current:1,pageSize:10,total:0}),g=i(!1),s=i({clientId:"",channelNo:""}),V=()=>{a.value.current=1,m(a.value.current,a.value.pageSize)},$=()=>{s.value={clientId:"",channelNo:""},a.value.current=1,m(a.value.current,a.value.pageSize)},m=async(t,e)=>{try{g.value=!0;const o={pageNo:t-1,pageSize:e,clientId:s.value.clientId,channelNo:s.value.channelNo},c=await A(o);k.value=c.data.map(r=>({...r,loading:!1})),a.value.total=c.data.length,a.value.current=t}catch(o){console.error("获取数据失败:",o)}finally{g.value=!1}},S=t=>{const{current:e,pageSize:o}=t;m(e,o)};M(()=>{m(a.value.current,a.value.pageSize)});const T=`${window.location.protocol}//${window.location.host}/`.replace(/\/$/,""),x=i(T),z=async t=>{t.loading=!0;try{const e=await D({fileName:t.fileName});L.success(e.message),await m(a.value.current,a.value.pageSize)}catch(e){console.log(e)}finally{t.loading=!1}},f=i(!1),p=i(""),h=i(""),F=t=>{p.value=`${x.value}/backend/jtt808/downloadRecordFile/${t.fileName}`,h.value=t.fileName,f.value=!0},R=()=>{f.value=!1,p.value="",h.value=""};return(t,e)=>{const o=u("a-input"),c=u("a-form-item"),r=u("a-button"),U=u("a-form"),P=u("a-table"),B=u("a-modal");return N(),y(w,null,[b("div",G,[l(U,{layout:"inline"},{default:n(()=>[l(c,{label:"终端手机号"},{default:n(()=>[l(o,{value:s.value.clientId,"onUpdate:value":e[0]||(e[0]=d=>s.value.clientId=d),placeholder:"请输入终端手机号"},null,8,["value"])]),_:1}),l(c,{label:"通道号"},{default:n(()=>[l(o,{value:s.value.channelNo,"onUpdate:value":e[1]||(e[1]=d=>s.value.channelNo=d),placeholder:"请输入通道号"},null,8,["value"])]),_:1}),l(c,null,{default:n(()=>[l(r,{onClick:V},{default:n(()=>e[3]||(e[3]=[_("搜索")])),_:1}),l(r,{style:{"margin-left":"8px"},onClick:$},{default:n(()=>e[4]||(e[4]=[_("重置")])),_:1})]),_:1})]),_:1})]),l(P,{columns:C,"data-source":k.value,pagination:a.value,onChange:S,loading:g.value,scroll:{x:"max-content"}},{bodyCell:n(({column:d,record:v})=>[d.key==="action"?(N(),y(w,{key:0},[b("a",{href:`${x.value}/backend/jtt808/downloadRecordFile/${v.fileName}`,style:{"margin-right":"10px"},download:v.fileName},"下载",8,H),l(r,{onClick:j=>F(v),style:{"margin-right":"10px"}},{default:n(()=>e[5]||(e[5]=[_("播放")])),_:2},1032,["onClick"]),l(r,{danger:"",onClick:j=>z(v),style:{"margin-right":"10px"},loading:v.loading},{default:n(()=>e[6]||(e[6]=[_("删除")])),_:2},1032,["onClick","loading"])],64)):I("",!0)]),_:1},8,["data-source","pagination","loading"]),l(B,{visible:f.value,"onUpdate:visible":e[2]||(e[2]=d=>f.value=d),title:`在线播放 - ${h.value}`,footer:null,width:"800px",onCancel:R},{default:n(()=>[p.value?(N(),y("video",{key:0,src:p.value,controls:"",muted:"",style:{width:"100%"}},null,8,J)):I("",!0)]),_:1},8,["visible","title"])],64)}}}),Z=q(K,[["__scopeId","data-v-02943205"]]);export{Z as default};
