import{d as b,G as N,r as d,j as R,b as I,c as o,w as n,f as i,g as Y,h as m,z as w,y as D,t as V,o as y,_ as H}from"./index-BYlyECpH.js";import{l as B}from"./zh_CN-CIeKJixd.js";import{l as L}from"./system-CujKZacu.js";import"./request-xFzgdMuq.js";const P=b({__name:"LogView",setup(j){N.locale("zh-cn");const c=d(!1),l=d({type:"",dateRange:[]}),v=[{title:"请求路径",dataIndex:"uri",key:"uri"},{title:"请求参数",dataIndex:"params",key:"params",ellipsis:!0},{title:"错误信息",dataIndex:"errorMessage",key:"errorMessage",ellipsis:!0},{title:"IP地址",dataIndex:"ip",key:"ip"},{title:"耗时",dataIndex:"costTime",key:"costTime"},{title:"操作时间",dataIndex:"createTime",key:"createTime"}],_=d([]),t=d({current:1,pageSize:10,total:0,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}),u=async e=>{var a,p;c.value=!0;try{const r={type:e.type,startTime:(a=e.dateRange[0])==null?void 0:a.format("YYYY-MM-DD HH:mm:ss"),endTime:(p=e.dateRange[1])==null?void 0:p.format("YYYY-MM-DD HH:mm:ss"),pageNo:e.pageNum,pageSize:e.pageSize},s=await L(r);s.code===200&&(_.value=s.data.content,t.value.total=s.data.page.totalElements)}catch(r){console.error("Failed to fetch logs:",r)}finally{c.value=!1}},x=e=>{t.value=e,u({...l.value,pageNum:e.current,pageSize:e.pageSize})},k=()=>{t.value.current=1,u({...l.value,pageNum:1,pageSize:t.value.pageSize})},S=()=>{l.value={type:"",dateRange:[]},t.value.current=1,u({type:"",dateRange:[],pageNum:1,pageSize:t.value.pageSize})},z=e=>({login:"green",operation:"blue",error:"red"})[e]||"default",h=e=>({login:"登录",operation:"操作",error:"错误"})[e]||e;return R(()=>{u({type:"",dateRange:[],pageNum:1,pageSize:t.value.pageSize})}),(e,a)=>{const p=i("a-range-picker"),r=i("a-form-item"),s=i("a-button"),T=i("a-form"),C=i("a-tag"),M=i("a-table");return y(),I("div",null,[o(T,{layout:"inline",model:l.value,class:"search-form",style:{"margin-bottom":"16px"}},{default:n(()=>[o(r,{label:"时间范围"},{default:n(()=>[o(p,{value:l.value.dateRange,"onUpdate:value":a[0]||(a[0]=g=>l.value.dateRange=g),placeholder:["开始时间","结束时间"],locale:Y(B)},null,8,["value","locale"])]),_:1}),o(r,null,{default:n(()=>[o(s,{onClick:k,loading:c.value},{default:n(()=>a[1]||(a[1]=[m("查询")])),_:1},8,["loading"]),o(s,{style:{"margin-left":"8px"},onClick:S},{default:n(()=>a[2]||(a[2]=[m("重置")])),_:1})]),_:1})]),_:1},8,["model"]),o(M,{columns:v,"data-source":_.value,pagination:t.value,loading:c.value,onChange:x},{bodyCell:n(({column:g,record:f})=>[g.key==="type"?(y(),w(C,{key:0,color:z(f.type)},{default:n(()=>[m(V(h(f.type)),1)]),_:2},1032,["color"])):D("",!0)]),_:1},8,["data-source","pagination","loading"])])}}}),U=H(P,[["__scopeId","data-v-d846c709"]]);export{U as default};
