import{i as N}from"./gbt28181-C3wyvrue.js";import{i as I}from"./index-u3wYLQ4o.js";import{c as t,I as R,d as W,r as o,j as A,k as E,b as L,w as a,f as v,i as F,e as n,t as m,h as k,g as x,o as J,_ as U}from"./index-BYlyECpH.js";import"./request-xFzgdMuq.js";var Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M442.3 677.6l199.4-156.7a11.3 11.3 0 000-17.7L442.3 346.4c-7.4-5.8-18.3-.6-18.3 8.8v313.5c0 9.4 10.9 14.7 18.3 8.9z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"play-square",theme:"outlined"};function T(r){for(var s=1;s<arguments.length;s++){var i=arguments[s]!=null?Object(arguments[s]):{},c=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(i).filter(function(d){return Object.getOwnPropertyDescriptor(i,d).enumerable}))),c.forEach(function(d){X(r,d,i[d])})}return r}function X(r,s,i){return s in r?Object.defineProperty(r,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[s]=i,r}var h=function(s,i){var c=T({},s,i.attrs);return t(R,T({},c,{icon:Q}),null)};h.displayName="PlaySquareOutlined";h.inheritAttrs=!1;const Y={class:"home-container"},Z={class:"card-content"},K={class:"card-main"},ee={class:"monitoring-buttons"},te={class:"card-content"},ae={class:"status-charts"},ne={class:"chart-wrapper"},se={class:"chart-title"},oe={class:"chart-wrapper"},ie={class:"chart-title"},le=W({__name:"MonitorView",setup(r){const s=o(""),i=o(""),c=o(""),d=o(""),w=o(""),S=o(0),P=o(0),C=o(0),D=o(0),z=o(0),M=o(0),b=o(),g=o();let u=null,f=null;const j=async()=>{try{const e=await N({});if(e.data){if(e.data.gbt28181){const{sipId:l,sipDomain:p,accessIp:y,sipPort:_,sipPassword:O}=e.data.gbt28181;s.value=l,i.value=p,c.value=y,d.value=_,w.value=O}e.data.devices&&e.data.channels&&G({devices:e.data.devices,channels:e.data.channels})}}catch(e){console.error("Failed to fetch info data:",e),F.error("Failed to load system information")}},q=()=>{b.value&&(u=I(b.value),u.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",right:"10%",top:"middle",itemWidth:8,itemHeight:8,textStyle:{fontSize:12}},series:[{name:"Device Status",type:"pie",radius:"50%",center:["30%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"center",formatter:"{d}%"},emphasis:{label:{show:!0}},data:[{value:0,name:"Offline"},{value:0,name:"Online"}]}]})),g.value&&(f=I(g.value),f.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",right:"10%",top:"middle",itemWidth:8,itemHeight:8,textStyle:{fontSize:12}},series:[{name:"Channel Status",type:"pie",radius:"50%",center:["30%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"center",formatter:"{d}%"},emphasis:{label:{show:!0}},data:[{value:0,name:"Offline"},{value:0,name:"Online"}]}]}))},G=e=>{S.value=e.devices.total,P.value=e.devices.online,C.value=e.devices.offline,D.value=e.channels.total,z.value=e.channels.online,M.value=e.channels.offline,u&&u.setOption({series:[{data:[{value:C.value,name:"Offline"},{value:P.value,name:"Online"}]}]}),f&&f.setOption({series:[{data:[{value:M.value,name:"Offline"},{value:z.value,name:"Online"}]}]})};return A(async()=>{q(),await j()}),E(()=>{u==null||u.dispose(),f==null||f.dispose()}),(e,l)=>{const p=v("a-descriptions-item"),y=v("a-descriptions"),_=v("a-button"),O=v("a-space"),V=v("a-card"),B=v("a-col"),$=v("a-row");return J(),L("div",Y,[t($,{gutter:[24,24],class:"monitoring-cards"},{default:a(()=>[t(B,{span:8},{default:a(()=>[t(V,{title:"Register Info",class:"register-info-card"},{default:a(()=>[n("div",Z,[n("div",K,[t(y,{column:1,size:"small"},{default:a(()=>[t(p,{label:"GB28181 ID"},{default:a(()=>[n("span",null,m(s.value),1)]),_:1}),t(p,{label:"GB28181 Domain"},{default:a(()=>[n("span",null,m(i.value),1)]),_:1}),t(p,{label:"IP Address"},{default:a(()=>[n("span",null,m(c.value),1)]),_:1}),t(p,{label:"Port"},{default:a(()=>[n("span",null,m(d.value),1)]),_:1}),t(p,{label:"Password"},{default:a(()=>[n("span",null,m(w.value),1)]),_:1})]),_:1})]),n("div",ee,[t(O,{style:{width:"80%"},size:"small"},{default:a(()=>[t(_,{type:"primary",block:"",size:"small",onClick:l[0]||(l[0]=H=>e.$router.push("/GBT28181/MonitorViewJessibuca"))},{icon:a(()=>[t(x(h))]),default:a(()=>[l[2]||(l[2]=k(" Jessibuca "))]),_:1}),t(_,{type:"primary",block:"",size:"small",onClick:l[1]||(l[1]=H=>e.$router.push("/GBT28181/MonitorViewMpegts"))},{icon:a(()=>[t(x(h))]),default:a(()=>[l[3]||(l[3]=k(" MPEGTS "))]),_:1})]),_:1})])])]),_:1})]),_:1}),t(B,{span:8},{default:a(()=>[t(V,{title:"Device & Channel Status",class:"device-stats-card"},{default:a(()=>[n("div",te,[n("div",ae,[n("div",ne,[n("div",{ref_key:"devicePieChart",ref:b,style:{height:"100%"}},null,512),n("div",se,"Device Status (Total: "+m(S.value)+")",1)]),n("div",oe,[n("div",{ref_key:"channelPieChart",ref:g,style:{height:"100%"}},null,512),n("div",ie,"Channel Status (Total: "+m(D.value)+")",1)])])])]),_:1})]),_:1})]),_:1})])}}}),fe=U(le,[["__scopeId","data-v-69381abd"]]);export{fe as default};
