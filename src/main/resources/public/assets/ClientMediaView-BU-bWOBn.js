import{h as U}from"./moment-C5S46NFB.js";import{F as P}from"./FlvPlayerModal-CXw7H9j7.js";import{g as T,s as D}from"./jtt808-PzOwMx6L.js";import{d as R,r,j as Y,b as x,e as B,c as l,w as n,f as v,F as k,h as m,y as H,i as K,o as C,_ as L}from"./index-BYlyECpH.js";import"./request-xFzgdMuq.js";const $={class:"search-form",style:{"margin-bottom":"16px"}},j=R({__name:"ClientMediaView",setup(E){const I=[{title:"创建时间",dataIndex:"createTime",key:"createTime",customRender:t=>U(t.value).format("YYYY-MM-DD HH:mm:ss")},{title:"类型",dataIndex:"type",key:"type"},{title:"终端手机号",dataIndex:"clientId",key:"clientId"},{title:"通道序号",dataIndex:"channelNo",key:"channelNo"},{title:"播放地址",dataIndex:"httpFlv",key:"httpFlv"},{title:"接收速率",dataIndex:"rxRate",key:"rxRate"},{title:"扩展信息",dataIndex:"extInfo",key:"extInfo"},{title:"操作",key:"action",fixed:"right",width:350}],_=r([]),a=r({current:1,pageSize:10,total:0}),f=r(!1),i=r({clientId:"",channelNo:""}),c=async(t,e)=>{f.value=!0;try{const o={pageNo:t-1,pageSize:e,clientId:i.value.clientId,channelNo:i.value.channelNo},u=await T(o);_.value=u.data.map(d=>({...d,loading:!1})),a.value.total=u.data.length,a.value.current=t}catch(o){console.error("获取数据失败:",o)}finally{f.value=!1}},b=t=>{const{current:e,pageSize:o}=t;c(e,o)};Y(()=>{c(a.value.current,a.value.pageSize)});const p=r(!1),h=r(""),g=r(!1),N=async t=>{g.value=!0;try{h.value=t.httpFlv,p.value=!0}catch(e){console.log(e)}finally{g.value=!1}},w=async t=>{t.loading=!0;try{const e=await D({mediaKey:t.mediaKey});K.success(e.message),await c(a.value.current,a.value.pageSize)}catch(e){console.log(e)}finally{t.loading=!1}},M=()=>{a.value.current=1,c(a.value.current,a.value.pageSize)},S=()=>{i.value={clientId:"",channelNo:""},a.value.current=1,c(a.value.current,a.value.pageSize)};return(t,e)=>{const o=v("a-input"),u=v("a-form-item"),d=v("a-button"),F=v("a-form"),V=v("a-table");return C(),x(k,null,[B("div",$,[l(F,{layout:"inline"},{default:n(()=>[l(u,{label:"终端手机号"},{default:n(()=>[l(o,{value:i.value.clientId,"onUpdate:value":e[0]||(e[0]=s=>i.value.clientId=s),placeholder:"请输入终端手机号"},null,8,["value"])]),_:1}),l(u,{label:"通道号"},{default:n(()=>[l(o,{value:i.value.channelNo,"onUpdate:value":e[1]||(e[1]=s=>i.value.channelNo=s),placeholder:"请输入通道号"},null,8,["value"])]),_:1}),l(u,null,{default:n(()=>[l(d,{onClick:M},{default:n(()=>e[4]||(e[4]=[m("搜索")])),_:1}),l(d,{style:{"margin-left":"8px"},onClick:S},{default:n(()=>e[5]||(e[5]=[m("重置")])),_:1})]),_:1})]),_:1})]),l(V,{columns:I,"data-source":_.value,pagination:a.value,onChange:b,loading:f.value,scroll:{x:"max-content"}},{bodyCell:n(({column:s,record:y})=>[s.key==="action"?(C(),x(k,{key:0},[l(d,{onClick:z=>N(y),style:{"margin-right":"10px"},loading:g.value},{default:n(()=>e[6]||(e[6]=[m("Play")])),_:2},1032,["onClick","loading"]),l(d,{danger:"",onClick:z=>w(y),style:{"margin-right":"10px"},loading:y.loading},{default:n(()=>e[7]||(e[7]=[m("停止")])),_:2},1032,["onClick","loading"])],64)):H("",!0)]),_:1},8,["data-source","pagination","loading"]),l(P,{visible:p.value,flvUrl:h.value,onCancel:e[2]||(e[2]=()=>p.value=!1),"onUpdate:visible":e[3]||(e[3]=s=>p.value=s)},null,8,["visible","flvUrl"])],64)}}}),Q=L(j,[["__scopeId","data-v-368a2b5d"]]);export{Q as default};
